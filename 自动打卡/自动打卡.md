### è‡ªåŠ¨æ‰“å¡

---

éƒ¨ç½²anacondaç¯å¢ƒ

```
conda create --name autooa python=3.10.14 //autooa  è™šæ‹Ÿç¯å¢ƒçš„åå­—å¯ä»¥æ”¹ï¼Œpythonç‰ˆæœ¬ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ”¹
conda autooa
pip install selenium

```

å®‰è£…**ChromeDriver**

```
https://googlechromelabs.github.io/chrome-for-testing/#stable  //æ ¹æ®ä½ chromeçš„ç‰ˆæœ¬å·ä¸‹è½½å¯¹åº”çš„chromedriver
```

æ²¡æ‰¾åˆ°ä½ å¯¹åº”çš„ç‰ˆæœ¬å·ï¼Œç›´æ¥åœ¨é“¾æ¥ä¸Šæ”¹æˆä½ å¯¹åº”çš„ç‰ˆæœ¬å·ï¼Œå†ä¸‹è½½ï¼ˆps:æˆ‘æ²¡æ‰¾åˆ°æˆ‘è°·æ­Œçš„ç‰ˆæœ¬å·ä¹Ÿæ˜¯è¿™ä¹ˆå¹²çš„ã€‚ã€‚ã€‚ï¼‰

chromedriverå­˜æ”¾ä½ç½®  /usr/local/bin/chromedriver

![chromedriver](https://github.com/hylsss/studyRecord/blob/main/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%A1/chromedriver%E5%AD%98%E6%94%BE%E4%BD%8D%E7%BD%AE.pic.jpg)


### éœ€è¦ä¿®æ”¹è·¯å¾„çš„åœ°æ–¹

####  **oaLogin.py**æ–‡ä»¶ä¸­çš„å­˜æ”¾çš„logçš„æ–‡ä»¶å¤¹

#### **oaLogin.py**ä¸­ç™»å½•çš„è´¦å·å¯†ç ,ä¿®æ”¹æˆè‡ªå·±çš„
![ä¿®æ”¹è´¦å·å¯†ç ](https://github.com/hylsss/studyRecord/blob/main/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%A1/%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81.pic.jpg)

#### **oa.sh** è¿è¡Œpythonè„šæœ¬çš„æ–‡ä»¶ï¼Œéœ€è¦æŠŠpythonçš„è·¯å¾„ä¿®æ”¹æˆä½ ä»¬è‡ªå·±çš„æ–‡ä»¶è·¯å¾„
```
source /opt/anaconda3/etc/profile.d/conda.sh   //æœ¬åœ°å®‰è£…anacondaçš„è·¯å¾„

conda info --envs

conda activate newenv   //æœ€åˆæŒ‡å®šçš„ç¯å¢ƒå®‰è£…è·¯å¾„

python3 /Users/ina.h/Documents/closeWechat/oaLogin.py  //ä¿®æ”¹æˆä½ ä»¬æ–‡ä»¶å¤¹çš„pythonè·¯å¾„
```
#### sleep.scpt  è¿™é‡Œç›¸å½“äºæ•´ä¸ªæ“ä½œçš„å¼€å…³
ä¿®æ”¹,oa.shè„šæœ¬çš„è·¯å¾„ï¼Œä¿®æ”¹æˆä½ æ–‡ä»¶å¤¹å¯¹åº”çš„
```
set shell_script_path to "/Users/ina.h/Documents/closeWechat/oa.sh"
```

ä¿®æ”¹logçš„è·¯å¾„ï¼Œä½ å¯ä»¥æŠŠlogæ–‡ä»¶åˆ æ‰ï¼Œåˆ›å»ºè‡ªå·±çš„logæ–‡ä»¶
```
set logFile to "/Users/ina.h/Documents/closeWechat/log.log"
```

#### ä¿®æ”¹å®Œæˆåå¯ä»¥ç›´æ¥æ‰§è¡Œsleep.scptè„šæœ¬ï¼ŒéªŒè¯ä½ çš„è„šæœ¬æ˜¯å¦ç”Ÿæ•ˆ
![æ‰§è¡Œ](https://github.com/hylsss/studyRecord/blob/main/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%A1/%E8%84%9A%E6%9C%AC%E6%89%A7%E8%A1%8C%E9%AA%8C%E8%AF%81.pic.jpg)

### æœ€åé…ç½®ä¸€ä¸ªå®šæ—¶ä»»åŠ¡
#### ä¿®æ”¹com.user.sleepwatcher.plist 

#####  åˆ›å»ºå®šæ—¶ä»»åŠ¡ï¼Œå¹¶ä¸”æŠŠcom.user.sleepwatcher.plistçš„å†…å®¹å¤åˆ¶è¿›å»
#### â—ï¸â—ï¸â—ï¸æœ€å¥½æ˜¯å…ˆä¸‹è½½lauchControlè½¯ä»¶ï¼Œç„¶å Reveal in finderç¡®è®¤ä¸€ä¸‹ä½ çš„å®šæ—¶ä»»åŠ¡æ˜¯æ”¾åœ¨å“ªä¸ªç›®å½•çš„ï¼Œä¸ç„¶æ”¾é”™ç›®å½•å®šæ—¶ä»»åŠ¡æ˜¯ä¸ç”Ÿæ•ˆçš„â—ï¸â—ï¸â—ï¸ç›´æ¥æŠŠcom.user.sleepwatcher.plistå¤åˆ¶åˆ°å¯¹åº”æ–‡ä»¶å¤¹ä¹Ÿä¸èƒ½ç”Ÿæ•ˆçš„ï¼Œä¼šæŠ¥æ²¡æƒé™ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦ç”¨å‘½ä»¤å»åˆ›å»ºæ¯”è¾ƒå¥½ã€‚

```
nano ~/Library/LaunchAgents/com.user.sleepwatcher.plist //
//ctrl + O ä¿å­˜
//enter 
//ctrl + x é€€å‡º
```


#### åŠ è½½å®šæ—¶ä»»åŠ¡

```
åŠ è½½ä»»åŠ¡ï¼šlaunchctl load /path/to/your.plistæ¥æ¿€æ´».plistæ–‡ä»¶å®šä¹‰çš„ä»»åŠ¡
å¸è½½ä»»åŠ¡ï¼šlaunchctl unload /path/to/your.plistæ¥åœæ­¢ä»»åŠ¡ã€‚
æ£€æŸ¥ä»»åŠ¡çŠ¶æ€:launchctl list | grep com.example.tasknameæ¥æ£€æŸ¥ç‰¹å®šä»»åŠ¡çš„è¿è¡ŒçŠ¶æ€ã€‚
```

**â—ï¸â—ï¸â—ï¸è¯·æ³¨æ„ è¯·æ³¨æ„ è¯·æ³¨æ„â—ï¸â—ï¸â—ï¸**

com.user.sleepwatcher.plistæ–‡ä»¶ä¸­æ‰“å¡æ—¶é—´æ˜¯

å‘¨ä¸€åˆ°å‘¨äº” æ—©ä¸Š7ç‚¹28åˆ†æ‰“å¡ï¼Œä¸­åˆ11ç‚¹38åˆ†æ‰“å¡ï¼Œç­¾å‡ºç­¾å…¥ä¸­é—´é—´éš”30ç§’

å…·ä½“æ—¶é—´å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„ä¹ æƒ¯æ‰“å¡ä¿®æ”¹ã€‚

**éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œç†„å±æƒ…å†µä¸‹æ˜¯æ‰“ä¸äº†å¡çš„ï¼ï¼ï¼ï¼**

**éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œç†„å±æƒ…å†µä¸‹æ˜¯æ‰“ä¸äº†å¡çš„ï¼ï¼ï¼ï¼**

**éœ€è¦æ³¨æ„çš„æ—¶å€™ï¼Œç†„å±æƒ…å†µä¸‹æ˜¯æ‰“ä¸äº†å¡çš„ï¼ï¼ï¼ï¼**



æ–‡ä»¶ä¸­æœ‰ä¸€ä¸ªç®¡ç†å®šæ—¶ä»»åŠ¡çš„å·¥å…·ğŸ”§ï¼Œ**å¦‚æœä½ çš„å®šæ—¶ä»»åŠ¡æ·»åŠ æˆåŠŸï¼Œä¼šåœ¨å·¥å…·é‡Œé¢åŠ è½½å‡ºæ¥com.user.sleepwatcher.plistï¼Œç®¡ç†å™¨å¯ä»¥æ§åˆ¶å®šæ—¶ä»»åŠ¡çš„å¼€å…³ã€‚**

!([/Users/ina.h/Library/Application Support/typora-user-images/image-20240823103600824.png](https://github.com/hylsss/studyRecord/blob/main/%E8%87%AA%E5%8A%A8%E6%89%93%E5%8D%A1/%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86.jpg))

---

#### éƒ¨ç½²å¥½ä¹‹åæœ€å¥½è¿˜æ˜¯ç›‘æµ‹ä¸€ä¸‹æ˜¯å¦æŒ‰æ—¶æ‰“å¡äº†ï¼ï¼ï¼ç›®å‰æˆ‘è‡ªå·±ç”¨äº†ä¸€ä¸ªæœˆï¼Œæ‰“å¡æ­£å¸¸ï¼Œç¥å¤§å®¶ä¸è¢«è–…ç¾Šæ¯›ã€‚
